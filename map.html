<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Map of Palestine – Returning to Haifa</title>

  <!-- Description for search / previews -->
  <meta name="description" content="Late Ottoman-era map of Palestine (1870s) with clickable markers for cities, villages, and areas as they existed before partition and the Nakba." />

  <style>
    :root{
      --bg:#0b0b0b;
      --panel:#0f0f10;
      --muted:#cfcfcf;
      --text:#f4f4f4;
      --border:#222;
      --accent:#e53935;
      --max-width:900px;
    }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
      background: var(--bg);
      color: var(--text);
      line-height:1.6;
    }

    header {
      padding: 2.5rem 1.5rem 1rem;
      border-bottom: 1px solid var(--border);
      background: var(--panel);
    }

    .container {
      max-width: var(--max-width);
      margin: 0 auto;
      padding: 0 1rem;
    }

    h1 {
      margin: 0 0 0.3rem 0;
      font-size: clamp(1.6rem, 2.2vw + 1rem, 2.2rem);
      line-height:1.05;
      letter-spacing: -0.01em;
    }

    .tagline {
      color: var(--muted);
      font-size: 0.95rem;
      letter-spacing: 0.04em;
      text-transform: uppercase;
      margin-top: 0.3rem;
    }

    nav {
      margin-top: 0.75rem;
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      align-items: center;
      font-size: 0.95rem;
    }

    nav a {
      color: var(--accent);
      text-decoration: none;
      margin-right: 0.75rem;
    }
    nav a:hover {
      text-decoration: underline;
    }

    /* Zoom buttons in header */
    .zoom-label {
      color: var(--muted);
      margin-right: 0.3rem;
    }

    nav button {
      background: #e53935;
      color: #000;
      border: 1px solid #fff;
      border-radius: 4px;
      padding: 0.1rem 0.5rem;
      font-size: 0.95rem;
      font-weight: 600;
      cursor: pointer;
    }

    nav button:hover {
      filter: brightness(1.1);
    }

    main {
      padding: 1.5rem 0 2rem;
    }

    .intro {
      font-size: 0.95rem;
      color: var(--muted);
      margin-bottom: 1.5rem;
    }

    /* Map layout */

    .map-wrapper {
      max-width: var(--max-width);
      margin: 0 auto;
      border-radius: 10px;
      border: 1px solid var(--border);
      overflow: hidden;
      background: #050505;
      position: relative;
    }

    .map-zoom-layer {
      position: relative;
      width: 100%;
      height: auto;
      transform-origin: 0 0;
      cursor: grab;
    }

    .map-zoom-layer:active {
      cursor: grabbing;
    }

    .map-image {
      width: 100%;
      height: auto;
      display: block;
      user-select: none;
      pointer-events: none; /* clicks go through to markers / zoom layer */
    }

    .map-marker {
      position: absolute;
      transform: translate(-50%, -50%);
      width: 14px;
      height: 14px;
      border-radius: 50%;
      border: 2px solid #000;
      background: var(--accent);
      cursor: pointer;
      box-shadow: 0 0 0 1px #fff, 0 0 6px rgba(0,0,0,0.8);
    }

    .map-marker:hover {
      transform: translate(-50%, -50%) scale(1.1);
    }

    .map-marker.active {
      box-shadow: 0 0 0 2px #fff, 0 0 14px rgba(229,57,53,0.9);
    }

    .map-info {
      max-width: var(--max-width);
      margin: 1rem auto 0;
      padding: 1rem 1.25rem 1.25rem;
      border-radius: 10px;
      border: 1px solid var(--border);
      background: var(--panel);
    }

    .map-info-title {
      margin: 0 0 0.4rem 0;
      font-size: 1.1rem;
    }

    .map-info-subtitle {
      margin: 0 0 0.6rem 0;
      font-size: 0.9rem;
      color: var(--muted);
    }

    .map-info-body {
      font-size: 0.95rem;
    }

    .coords-hint {
      margin-top: 0.6rem;
      font-size: 0.8rem;
      color: var(--muted);
      opacity: 0.9;
    }

    footer {
      border-top: 1px solid var(--border);
      padding: 1.25rem 0;
      color: var(--muted);
      font-size: 0.9rem;
      background: var(--panel);
      margin-top: 2rem;
    }
  </style>
</head>

<body>

  <header>
    <div class="container">
      <h1>Map of Palestine</h1>
      <div class="tagline">Late Ottoman Palestine. Our land, our places.</div>
      <nav>
        <a href="index.html">← Home</a>
        <span class="zoom-label">Zoom:</span>
        <button type="button" id="zoom-in">+</button>
        <button type="button" id="zoom-out">−</button>
      </nav>
    </div>
  </header>

  <main>
    <div class="container">
      <p class="intro">
        Background: a 19th-century survey map of Palestine (PEF Survey of Western Palestine,
        mapped between 1872–1877 under Ottoman rule). The population at this time was
        overwhelmingly Palestinian Arabs – mostly Muslims, with Christian and smaller Jewish
        communities in the cities and towns. On top of this map we mark cities, villages, and
        areas whose names and people will later be targeted, displaced, or massacred in the
        20th century.
      </p>
    </div>

    <!-- Map image + markers -->
    <div class="map-wrapper" id="map-wrapper">
      <div class="map-zoom-layer" id="map-zoom-layer">
        <img
          src="palestine-map-1870s.jpg"
          alt="PEF Survey of Western Palestine, 19th-century map of Palestine under Ottoman rule"
          class="map-image"
        />

        <!-- Markers (positions you can refine with the helper) -->

        <!-- al-Quds / Jerusalem -->
        <button
          type="button"
          class="map-marker"
          style="top: 44%; left: 54%;"
          data-title="al-Quds (Jerusalem)"
          data-subtitle="Late Ottoman district and religious center"
          data-body="In the 1870s, al-Quds (Jerusalem) was an Ottoman district center with a majority of Arabic-speaking Muslim and Christian Palestinians, alongside a historic Jewish community. It was a religious, administrative, and trading hub long before foreign partition lines were imposed."
          aria-label="al-Quds (Jerusalem)"
        ></button>

        <!-- Gaza -->
        <button
          type="button"
          class="map-marker"
          style="top: 51%; left: 14%;"
          data-title="Gaza"
          data-subtitle="Ottoman town and trade hub"
          data-body="Gaza was an important town on the coastal road between Egypt and the rest of Greater Syria. In the late Ottoman period it was a center for agriculture and caravan trade, inhabited mainly by Palestinian Arabs, with life tied to surrounding villages and fields."
          aria-label="Gaza"
        ></button>

        <!-- Haifa -->
        <button
          type="button"
          class="map-marker"
          style="top: 19%; left: 42%;"
          data-title="Haifa"
          data-subtitle="Growing port town on the Mediterranean"
          data-body="In the 19th century, Haifa was a small but growing port on the Bay of Haifa, under Ottoman administration. Its population was mostly Arab Muslims and Christians, with small Jewish and European communities, and it was beginning to develop as a regional maritime gateway."
          aria-label="Haifa"
        ></button>

        <!-- Yafa / Jaffa -->
        <button
          type="button"
          class="map-marker"
          style="top: 38%; left: 29%;"
          data-title="Yafa (Jaffa)"
          data-subtitle="Major Palestinian port city"
          data-body="Yafa was the main port of Palestine, serving Jerusalem and the interior. In the 1870s it was a bustling Arab city known for citrus groves, soap production, and trade, with a largely Muslim and Christian Palestinian population and a growing role in Mediterranean commerce."
          aria-label="Yafa (Jaffa)"
        ></button>

        <!-- Deir Yassin -->
        <button
          type="button"
          class="map-marker"
          style="top: 44%; left: 51%;"
          data-title="Deir Yassin"
          data-subtitle="Agricultural village west of al-Quds"
          data-body="Deir Yassin was a small Palestinian village west of al-Quds, sustained by agriculture and tied to surrounding villages and markets. On this 19th-century map it appears simply as part of the rural landscape – decades before it would be known for the 1948 massacre carried out there."
          aria-label="Deir Yassin"
        ></button>

        <!-- Jenin area -->
        <button
          type="button"
          class="map-marker"
          style="top: 28%; left: 58%;"
          data-title="Jenin area"
          data-subtitle="Market town and surrounding villages"
          data-body="In the late Ottoman period, Jenin was a small market town serving nearby villages in the northern highlands of Palestine. The population was overwhelmingly Palestinian Arab, living from agriculture and trade. The refugee camp that will later carry the name 'Jenin camp' did not yet exist."
          aria-label="Jenin area"
        ></button>
      </div>
    </div>

    <!-- Info panel -->
    <section class="map-info" id="map-info">
      <h2 class="map-info-title" id="map-info-title">Click a place on the map</h2>
      <p class="map-info-subtitle" id="map-info-subtitle">
        Cities, villages, and regions in late Ottoman Palestine, decades before partition and the Nakba.
      </p>
      <p class="map-info-body" id="map-info-body">
        Choose one of the red points above to read a short description of how this place existed
        in the 19th century. Later, these same locations can be linked to 20th-century wars,
        expulsions, refugee camps, and acts of resistance tied to the same land.
      </p>
      <div class="coords-hint" id="coords-hint">
        Helper: click anywhere on the map background to see suggested <code>top</code>/<code>left</code> percentages for placing or correcting a marker.
      </div>
    </section>
  </main>

  <footer>
    <div class="container">
      © Returning to Haifa. Maps are never neutral – this one insists Palestine was already full.
    </div>
  </footer>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const infoTitleEl    = document.getElementById('map-info-title');
      const infoSubtitleEl = document.getElementById('map-info-subtitle');
      const infoBodyEl     = document.getElementById('map-info-body');
      const infoBox        = document.getElementById('map-info');

      const markers        = document.querySelectorAll('.map-marker');
      const wrapper        = document.getElementById('map-wrapper');
      const zoomLayer      = document.getElementById('map-zoom-layer');
      const zoomInBtn      = document.getElementById('zoom-in');
      const zoomOutBtn     = document.getElementById('zoom-out');
      const coordsHintEl   = document.getElementById('coords-hint');

      // Marker click behaviour
      function clearActiveMarkers() {
        markers.forEach(m => m.classList.remove('active'));
      }

      markers.forEach(marker => {
        marker.addEventListener('click', (event) => {
          event.stopPropagation();

          const title    = marker.getAttribute('data-title') || '';
          const subtitle = marker.getAttribute('data-subtitle') || '';
          const body     = marker.getAttribute('data-body') || '';

          infoTitleEl.textContent    = title;
          infoSubtitleEl.textContent = subtitle;
          infoBodyEl.textContent     = body;

          clearActiveMarkers();
          marker.classList.add('active');

          infoBox.scrollIntoView({ behavior: 'smooth', block: 'start' });
        });
      });

      // Helper: click on map background to get suggested top/left
      zoomLayer.addEventListener('click', (event) => {
        if (event.target.classList.contains('map-marker')) return;

        const rect = zoomLayer.getBoundingClientRect();
        const x = ((event.clientX - rect.left) / rect.width) * 100;
        const y = ((event.clientY - rect.top)  / rect.height) * 100;

        const topPercent  = y.toFixed(1);
        const leftPercent = x.toFixed(1);

        const text = `Suggested CSS → top: ${topPercent}%; left: ${leftPercent}%;  (paste into the marker style)`;
        if (coordsHintEl) {
          coordsHintEl.textContent = text;
        }
        console.log(text);
      });

      // Zoom + pan (buttons only, with bounds)
      let scale = 1;
      let originX = 0;
      let originY = 0;
      let isDragging = false;
      let startX = 0;
      let startY = 0;
      let baseWidth = 0;
      let baseHeight = 0;

      function measureBaseSize() {
        if (!baseWidth || !baseHeight) {
          baseWidth = zoomLayer.offsetWidth;
          baseHeight = zoomLayer.offsetHeight;
        }
      }

      function clampPan() {
        measureBaseSize();

        const wrapperWidth = wrapper.clientWidth;
        const wrapperHeight = wrapper.clientHeight;
        const scaledWidth = baseWidth * scale;
        const scaledHeight = baseHeight * scale;

        const minX = Math.min(0, wrapperWidth - scaledWidth);
        const maxX = 0;
        const minY = Math.min(0, wrapperHeight - scaledHeight);
        const maxY = 0;

        originX = Math.min(Math.max(originX, minX), maxX);
        originY = Math.min(Math.max(originY, minY), maxY);
      }

      function centerMap() {
        measureBaseSize();
        const wrapperWidth = wrapper.clientWidth;
        const wrapperHeight = wrapper.clientHeight;
        const scaledWidth = baseWidth * scale;
        const scaledHeight = baseHeight * scale;

        originX = (wrapperWidth - scaledWidth) / 2;
        originY = (wrapperHeight - scaledHeight) / 2;
      }

      function updateTransform() {
        clampPan();
        zoomLayer.style.transform =
          `translate(${originX}px, ${originY}px) scale(${scale})`;
      }

      function changeZoom(direction) {
        const step = 0.2;
        if (direction === 'in') {
          scale += step;
        } else {
          scale -= step;
        }
        scale = Math.min(Math.max(1, scale), 4);
        updateTransform();
      }

      if (zoomInBtn) {
        zoomInBtn.addEventListener('click', () => changeZoom('in'));
      }
      if (zoomOutBtn) {
        zoomOutBtn.addEventListener('click', () => changeZoom('out'));
      }

      // Drag start
      zoomLayer.addEventListener('mousedown', (e) => {
        isDragging = true;
        startX = e.clientX - originX;
        startY = e.clientY - originY;
      });

      // Drag move
      window.addEventListener('mousemove', (e) => {
        if (!isDragging) return;
        originX = e.clientX - startX;
        originY = e.clientY - startY;
        updateTransform();
      });

      // Drag end
      window.addEventListener('mouseup', () => {
        isDragging = false;
      });

      // Initial center after layout
      window.addEventListener('load', () => {
        scale = 1;
        measureBaseSize();
        centerMap();
        updateTransform();
      });
    });
  </script>

</body>
</html>
